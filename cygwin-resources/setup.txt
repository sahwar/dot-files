# Instructions for setting my basic working cygwin environment

# Install the following packages using the setup.exe utility:

X-start-menu-icons
autoconf
automake
gcc4
git
git-svn
libX11-devel
libXt-devel
libatk1.0-devel
libcairo-devel
libglib2.0-devel
libgtk2.0-devel
libmpfr4
libncurses-devel
libpango1.0-devel
libpixman1-devel
make
mercurial
nc
openssh
perl
pkg-config
pulseaudio # if you want sound support for the VM
python
rsh
ruby
rxvt-unicode-X
wget
xhost
xinit
xorg-docs
xorg-server
xrdb
zsh

# Compile vim from source since the one packaged by cygwin is stripped:

$ hg clone https://vim.googlecode.com/hg/ vim
$ cd vim
$ hg checkout [some version]
$ ./configure --prefix=/usr --enable-multibyte --enable-pythoninterp --enable-rubyinterp --enable-perlinterp --enable-gui=gtk2 --disable-gtktest
$ make && make install

# Pulseaudio configuration

On the file /etc/pulse/default.pa, add the following line:

load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1;192.168.56.0/24 auth-anonymous=1

On the file /etc/pulse/daemon.conf add:

exit-idle-time = -1
daemonize = yes

This will enable remote anonymous connections in the virtualbox network.
On a ubuntu VM, install the required packages:

  sudo apt-get install libasound2 libasound2-plugins alsa-utils

And configure ALSA to send its output to pulseaudio by default, put this
on ~/.asoundrc:

  pcm.pulse {
      type pulse
  }
  ctl.pulse {
      type pulse
  }
  pcm.!default {
      type pulse
      hint.description "Default Audio Device"
  }
  ctl.!default {
      type pulse
  }

In the guest, create a shell startup file with this content

  # use cygwin x-server to display graphical applications
  export DISPLAY='192.168.56.1:0.0'
  # tell the init scripts we are in cygwin, so no need to
  # do normal x action such as keyboard setup
  export CYGWIN_X=1
  # use cygwin x-server to render opengl apps
  export LIBGL_ALWAYS_INDIRECT=1
  # use cygwin pulseaudio server as the default sink for audio
  export PULSE_SERVER='192.168.56.1' 
